<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap"
      rel="stylesheet"
    />
    <title>Al Foursan</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    <script>
      window.API_BASE_URL =
        "https://alfursantracking.com/api/v1/tenant/get-devices";

      function getSettings(id, command) {
        alert("Settings for car ID: " + id + " and command: " + command);
      }

      function openShareModal(id, serialNumber) {
        alert(
          "Settings for car ID: " + id + " and serial number: " + serialNumber
        );
      }

      function showFenceModal() {
        alert("Fence modal opened");
      }

      function confirmGeofenceSettings(polygon) {
        alert("Geofence settings confirmed" + JSON.stringify(polygon));
      }

      function editShape({ type, data }) {
        if (!type || !data) {
          console.error("❌ لازم تبعت type و data");
          return;
        }

        let shapeData;

        if (type === "polygon") {
          if (!Array.isArray(data.polygonData)) {
            console.error("❌ لازم تبعت polygonData كمصفوفة من الإحداثيات");
            return;
          }

          shapeData = {
            type: "polygon",
            polygonData: data.polygonData,
          };
        } else if (type === "circle") {
          if (!data.center || typeof data.radius !== "number") {
            console.error("❌ لازم تبعت center و radius");
            return;
          }

          shapeData = {
            type: "circle",
            center: data.center,
            radius: data.radius,
          };
        } else {
          console.error("❌ نوع غير معروف:", type);
          return;
        }

        console.log("📤 إرسال شكل للتعديل:", shapeData);
        window.dispatchEvent(
          new CustomEvent("edit-shape", { detail: shapeData })
        );
      }

      window.editShape = editShape;
    </script>
  </body>
</html>
